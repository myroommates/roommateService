angular.module("tmh.dynamicLocale").config(["tmhDynamicLocaleProvider",function(a){a.localeLocationPattern("/assets/components/angular-i18n/angular-locale_{{locale}}.js")}]);var myApp=angular.module("app",["ui.bootstrap.datetimepicker","ui.bootstrap","angucomplete","tmh.dynamicLocale"]);myApp.controller("MainCtrl",["$scope","$locale","tmhDynamicLocale","translationService","$modal",function(a,b,c,d,e){"data"in window&&void 0!=data&&null!=data&&(c.set(data.langId),d.set(data.translations)),a.helpDisplayed=!1,a.displayHelp=function(){a.helpDisplayed=!0},a.maskHelp=function(){a.helpDisplayed=!1},a.openHelp=function(a){var b={message:function(){return a}};e.open({templateUrl:"/assets/javascripts/modal/HelpModal/view.html",controller:"HelpModalCtrl",size:"sm",resolve:b})}}]),myApp.controller("HomeCtrl",["$scope","$modal",function(a,b){a.mySelf=data.mySelf,a.moneySymbol=data.home.moneySymbol,a.ticketList=ticketList,a.shoppingItemList=shoppingItemList,a.roommateList=data.roommateList,a.moneySymbol=data.home.moneySymbol,a.sortTicketList=function(){a.shoppingItemList=_.sortBy(a.shoppingItemList,function(a){return-a.creationDate})},a.sortTicketList(),a.computeCountBalance=function(){var b=0,c=0;for(var d in a.ticketList)for(var e in a.ticketList[d].debtorList)a.ticketList[d].payerId==a.mySelf.id&&(b+=a.ticketList[d].debtorList[e].value),a.ticketList[d].debtorList[e].roommateId==a.mySelf.id&&(c+=a.ticketList[d].debtorList[e].value);return b-c},a.getTotalItemSelected=function(){var b=0;for(var c in a.shoppingItemList)a.shoppingItemList[c].selected&&1==a.shoppingItemList[c].selected&&b++;return b},a.addItem=function(b){a.ticketList.push(b);for(var c=a.shoppingItemList.length-1;c>=0;c--)a.shoppingItemList[c].selected&&1==a.shoppingItemList[c].selected&&a.shoppingItemList.splice(c,1)},a.resolveSelectedItem=function(){var c=[];for(var d in a.shoppingItemList)a.shoppingItemList[d].selected&&1==a.shoppingItemList[d].selected&&c.push(a.shoppingItemList[d]);var e=[];for(var d in a.ticketList)a.ticketList[d].category&&0==_.contains(e,a.ticketList[d].category)&&e.push(a.ticketList[d].category);var f={roommateList:function(){return roommateList},ticket:function(){return null},addItem:function(){return a.addItem},categoryList:function(){return e},moneySymbol:function(){return a.moneySymbol},shoppingItemList:function(){return c}};b.open({templateUrl:"/assets/javascripts/modal/CUTicket/view.html",controller:"CuTicketCtrl",size:"lg",resolve:f})},a.createTicket=function(){var c=[];for(var d in a.ticketList)a.ticketList[d].category&&0==_.contains(c,a.ticketList[d].category)&&c.push(a.ticketList[d].category);var e={roommateList:function(){return roommateList},ticket:function(){return null},addItem:function(){return function(b){a.ticketList.push(b)}},categoryList:function(){return c},moneySymbol:function(){return a.moneySymbol},shoppingItemList:function(){return null}};b.open({templateUrl:"/assets/javascripts/modal/CUTicket/view.html",controller:"CuTicketCtrl",size:"lg",resolve:e})},a.createShoppingItem=function(){var c={shoppingItem:function(){return null},addItem:function(){return function(b){a.shoppingItemList.push(b),a.sortTicketList()}},data:function(){return data}};b.open({templateUrl:"/assets/javascripts/modal/CUShoppingItem/view.html",controller:"CuShoppingItemCtrl",size:"lg",resolve:c})}}]),myApp.controller("AdminRoommateListCtrl",["$scope","$http","$flash","translationService","$locale",function(a,b,c){a.roommateList=initialData,a.moneySymbol=data.home.moneySymbol,a.edit=function(a){a.edit=!a.edit},a.remove=function(d){if(d.id)d.isLoading=!0,b({method:"DELETE",url:"/rest/roommate/"+d.id,headers:"Content-Type:application/json"}).success(function(){for(var b=0;b<a.roommateList.length;b++)a.roommateList[b]==d&&a.roommateList.splice(b,1);d.isLoading=!1}).error(function(a){c.error(a.message),d.isLoading=!1});else for(var e=0;e<a.roommateList.length;e++)a.roommateList[e]==d&&a.roommateList.splice(e,1)},a.save=function(d){var e="",f="/rest/roommate";null!=d.id&&void 0!=d.id?(e="PUT",f+="/"+d.id):e="POST",d.isLoading=!0,b({method:e,url:f,headers:"Content-Type:application/json",data:d}).success(function(b){for(var c=0;c<a.roommateList.length;c++)a.roommateList[c]==d&&a.roommateList.splice(c,1,b);d.edit=!1,d.isLoading=!1}).error(function(a){c.error(a.message),null!=d.id&&(d.edit=!1),d.isLoading=!1})},a.add=function(){a.roommateList.push({id:null,nameAbrv:"",name:"",email:"",edit:!0})}}]),myApp.controller("AdminPreferenceCtrl",["$scope","$flash","$http",function(a,b,c){a.home=data.home,a.fields={currency:{fieldTitle:"admin.preferences.currency",validationRegex:"^.{1,3}$",validationMessage:["generic.validation.size","1","255"],disabled:function(){return a.loading}}},a.initialize=function(){a.fields.currency.field=data.home.moneySymbol},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.initialize(),a.save=function(){for(var d in a.fields){var e=a.fields[d];a.fields.hasOwnProperty(d)&&(e.firstAttempt=!1)}if(a.allFieldValid()){var f={moneySymbol:a.fields.currency.field};a.loading=!0,c({method:"PUT",url:"/rest/home/"+a.home.id,headers:"Content-Type:application/json",data:f}).success(function(){a.loading=!1}).error(function(c){a.loading=!1,b.error(c.message)})}}}]),myApp.controller("LateralMenuCtrl",["$scope",function(a){a.itemOpen=[],a.switchVisibility=function(b){a.itemOpen[b]=!a.menuItemOpen(b)},a.menuItemOpen=function(b){return void 0==a.itemOpen[b]||0==a.itemOpen[b]?!1:!0}}]),myApp.controller("CountResumeCtrl",["$scope","$http","$flash","$modal","translationService","$locale",function(a){a.ticketList=ticketList.list,a.moneySymbol=data.home.moneySymbol,a.countResumeList=_.sortBy(countResumeList.list,function(a){return a.roommate.id}),a.sub=function(a,b){return a-b},a.totalSpend=function(){var b=0;for(var c in a.countResumeList)b+=a.countResumeList[c].spend;return b},a.totalDept=function(){var b=0;for(var c in a.countResumeList)b+=a.countResumeList[c].dept;return b},a.computeResult=function(){var b=[];for(var c in a.countResumeList){var d=a.countResumeList[c].roommate,e={roommate:d,payed:0,mustPay:0};for(var f in a.ticketList){var g=a.ticketList[f];for(var h in g.debtorList)g.payerId==d.id&&(e.payed+=g.debtorList[h].value),g.debtorList[h].roommateId==d.id&&(e.mustPay+=g.debtorList[h].value)}e.resetToReceive=e.payed-e.mustPay,b.push(e)}a.balanceList=[];for(c in b){var e=b[c],i=e.payed-e.mustPay;if(0>i)for(f in b){var j=b[f];if(j.resetToReceive>0){var k=null;for(h in a.balanceList)balanceToFind=a.balanceList[h],balanceToFind.from.id==e.roommate.id&&balanceToFind.to.id==j.roommate.id&&(k=balanceToFind);if(null==k&&(k={},k.from=e.roommate,k.to=j.roommate,k.value=0),a.balanceList.push(k),j.resetToReceive>=Math.abs(i)){k.value+=Math.abs(i),j.resetToReceive-=Math.abs(i);break}k.value+=j.resetToReceive,i+=j.resetToReceive,j.resetToReceive=0}}}},a.computeResult()}]),myApp.controller("CountTicketCtrl",["$scope","$http","$flash","$modal","translationService","$locale","tmhDynamicLocale",function(a,b,c,d){a.myself=data.mySelf,a.moneySymbol=data.home.moneySymbol,a.ticketList=ticketList.list,a.sortSelection=[{ref:"date",label:"count.ticket.sort.date"},{ref:"category",label:"count.ticket.sort.category"},{ref:"payer",label:"count.ticket.sort.payer"}],a.sortOption="date";for(var e in a.ticketList)a.ticketList[e].debtorList=_.sortBy(a.ticketList[e].debtorList,function(a){return a.roommateId});a.sort=function(){a.sortBy(a.sortOption)},a.sortBy=function(b){a.ticketList=_.sortBy(a.ticketList,function(a){return"payer"==b?a.payerId:"category"==b?a.category:"date"==b?-a.date:void 0})},a.sort(),a.$watch("sortOption",function(b,c){b!=c&&a.sortBy(a.sortOption)}),a.getRoommate=function(a){for(var b in roommateList)if(roommateList[b].id==a)return roommateList[b];return null},a.addItem=function(b){for(var c in a.ticketList)if(a.ticketList[c].id==b.id)return void a.ticketList.splice(c,1,b);a.ticketList.push(b),a.sort()},a.remove=function(d){d.isLoading=!0,b({method:"DELETE",url:"/rest/ticket/"+d.id,headers:"Content-Type:application/json"}).success(function(){d.isLoading=!1;for(var b in a.ticketList)a.ticketList[b].id==d.id&&a.ticketList.splice(b,1)}).error(function(a){d.isLoading=!1,c.error(a.message)})},a.getGlobalValue=function(a){var b=0;for(var c in a.debtorList)b+=a.debtorList[c].value;return b},a.createOrEditTicket=function(b){var c=[];for(var e in a.ticketList)a.ticketList[e].category&&0==_.contains(c,a.ticketList[e].category)&&c.push(a.ticketList[e].category);var f={roommateList:function(){return roommateList},ticket:function(){return b},addItem:function(){return a.addItem},categoryList:function(){return c},moneySymbol:function(){return a.moneySymbol},shoppingItemList:function(){return null}};d.open({templateUrl:"/assets/javascripts/modal/CUTicket/view.html",controller:"CuTicketCtrl",size:"lg",resolve:f})}}]),myApp.controller("ProfileMyProfileCtrl",["$scope","$http","$flash","$modal","translationService","$window",function(a,b,c,d,e,f){a.roommate=data.mySelf,a.languages=data.languages,a.moneySymbol=data.home.moneySymbol,a.loading=!1,a.languagesList=[];for(var g in a.languages)a.languages.hasOwnProperty(g)&&a.languagesList.push({key:a.languages[g].code,value:a.languages[g].language});a.fields={languages:{fieldTitle:"generic.yourLanguage",options:a.languagesList,field:data.langId,disabled:function(){return a.loading}},name:{fieldTitle:"generic.yourName",validationRegex:"^[a-zA-Z0-9-_%]{1,50}$",validationMessage:["generic.validation.size","1","50"],field:a.roommate.name,focus:function(){return!0},disabled:function(){return a.loading}},nameAbrv:{fieldTitle:"generic.yourNameAbrv",validationRegex:"^[a-zA-Z0-9-_%]{1,3}$",validationMessage:["generic.validation.size","1","3"],field:a.roommate.nameAbrv,disabled:function(){return a.loading}},email:{fieldType:"email",name:"email",fieldTitle:"changeEmailModal.email",validationRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,validationMessage:"generic.validation.email",field:a.roommate.email,disabled:function(){return a.loading}}},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.changePassword=function(){var b={roommate:function(){return a.roommate}};d.open({templateUrl:"/assets/javascripts/modal/ChangePassword/view.html",controller:"ChangePasswordModalCtrl",size:"lg",resolve:b})},a.setEmail=function(b){a.roommate.email=b},a.changeEmail=function(){var b={roommate:function(){return a.roommate},setEmail:function(){return a.setEmail}};d.open({templateUrl:"/assets/javascripts/modal/ChangeEmail/view.html",controller:"ChangeEmailModalCtrl",size:"lg",resolve:b})},a.save=function(){if(a.allFieldValid()){var d={name:a.fields.name.field,nameAbrv:a.fields.nameAbrv.field,languageCode:a.fields.languages.field,email:a.fields.email.field};a.loading=!0,b({method:"PUT",url:"/rest/roommate/"+a.roommate.id,headers:"Content-Type:application/json",data:d}).success(function(b){a.loading=!1,a.fields.languages.field!=b.langId&&f.location.reload()}).error(function(b){a.loading=!1,c.error(b.message)})}}}]),myApp.controller("ShoppingListCtrl",["$scope","$http","$flash","$modal","translationService","$locale","tmhDynamicLocale",function(a,b,c,d){a.myself=data.mySelf,a.shoppingItemList=shoppingItemList.list,a.sortSelection=[{ref:"date",label:"generic.date"},{ref:"creator",label:"generic.creator"}],a.sortOption="date",a.sort=function(){a.sortBy(a.sortOption)},a.sortBy=function(b){a.shoppingItemList=_.sortBy(a.shoppingItemList,function(a){return"creator"==b?a.creatorId:"date"==b?-a.creationDate:void 0})},a.sort(),a.$watch("sortOption",function(b,c){b!=c&&a.sortBy(a.sortOption)}),a.getRoommate=function(a){for(var b in roommateList)if(roommateList[b].id==a)return roommateList[b];return null},a.addItem=function(b){for(var c in a.shoppingItemList)if(a.shoppingItemList[c].id==b.id)return void a.shoppingItemList.splice(c,1,b);a.shoppingItemList.push(b),a.sort()},a.remove=function(d){d.isLoading=!0,b({method:"DELETE",url:"/rest/shoppingItem/"+d.id,headers:"Content-Type:application/json"}).success(function(){d.isLoading=!1;for(var b in a.shoppingItemList)a.shoppingItemList[b].id==d.id&&a.shoppingItemList.splice(b,1)}).error(function(a){d.isLoading=!1,c.error(a.message)})},a.createOrEditShoppingItem=function(b){var c={shoppingItem:function(){return b},addItem:function(){return a.addItem},data:function(){return data}};d.open({templateUrl:"/assets/javascripts/modal/CUShoppingItem/view.html",controller:"CuShoppingItemCtrl",size:"lg",resolve:c})}}]),myApp.controller("SuperAdminFaqCtrl",["$scope","$http","$flash","$modal","translationService","$locale","tmhDynamicLocale",function(a,b,c,d){a.faqs=faqs,a.langs=langs,a.surveys=surveys,a.createNewFaq=function(){var b={langs:function(){return a.langs}};d.open({templateUrl:"/assets/javascripts/modal/CreateFaq/view.html",controller:"CreateFaqModalCtrl",size:"lg",resolve:b})},a.createNewSurvey=function(){var b={langs:function(){return a.langs}};d.open({templateUrl:"/assets/javascripts/modal/createSurveyModal/view.html",controller:"CreateSurveyModalCtrl",size:"lg",resolve:b})}}]),myApp.controller("RegistrationCtrl",["$scope",function(a){a.nameAbrv="",a.name="",a.$watch("name",function(){a.nameAbrv=a.name.slice(0,3)})}]),myApp.controller("AboutCtrl",["$scope","$modal",function(a,b){a.openCalculator=function(){var a={setResult:function(){return function(a){scope.getInfo().field=a}}};b.open({templateUrl:"/assets/javascripts/modal/Calculator/view.html",controller:"CalculatorModalCtrl",size:"sm",resolve:a})}}]),myApp.controller("LoginCtrl",["$scope","$modal",function(a,b){a.forgotPassword=function(){b.open({templateUrl:"/assets/javascripts/modal/ForgotPassword/view.html",controller:"ForgotPasswordModalCtrl",size:"lg"})}}]),myApp.controller("WelcomeCtrl",["$scope","$modal","$window","$flash","$http",function(a,b,c,d,e){a.languages=languages,a.languagesList=[],a.lang=lang.split("-")[0],a.langIni=angular.copy(a.lang);for(var f in a.languages)a.languages.hasOwnProperty(f)&&a.languagesList.push({key:a.languages[f].code,value:a.languages[f].language});console.log(a.languagesList),a.$watch("lang",function(){a.lang!=a.langIni&&e({method:"GET",url:"/changeLanguage/"+a.lang,headers:"Content-Type:application/json"}).success(function(){c.location.reload()}).error(function(a){d.error(a.message)})})}]),myApp.controller("CuTicketCtrl",["$scope","$http","$flash","$modalInstance","roommateList","ticket","addItem","categoryList","moneySymbol","shoppingItemList","$filter","$modal",function(a,b,c,d,e,f,g,h,i,j,k){a.roommateList=e,a.balanced=!0,a.categoryList=h,a.loading=!1,a.mySelf=data.mySelf,a.money=i,a.shoppingItemList=j,a.fields={description:{fieldTitle:"generic.description",validationRegex:"[a-zA-Z0-9-]{1,255}",validationMessage:["generic.validation.size","1","255"],focus:function(){return!0},disabled:function(){return a.loading}},date:{fieldTitle:"generic.date",validationMessage:"generic.validation.date",field:new Date,disabled:function(){return a.loading}},value:{fieldTitle:"generic.total",validationRegex:".+",validationMessage:"generic.validation.notNull",numbersOnly:"double",hasCalculator:!0,disabled:function(){return a.loading||!a.balanced},money:a.money},category:{fieldTitle:"generic.category",autoCompleteValue:h,disabled:function(){return a.loading}}},a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.initialize=function(){for(var b in a.roommateList)roommate=a.roommateList[b],a.fields[roommate.id]={numbersOnly:"double",field:"",isDebtor:!0,isValid:!0},a.addWatch(roommate.id);if(f){a.edit=!0,a.fields.description.field=angular.copy(f.description),a.fields.date.field=angular.copy(f.date),a.fields.category.field=angular.copy(f.category);var c=0,d=f.debtorList[0].value;for(var b in e){for(var g in f.debtorList){var h=!1;if(f.debtorList[g].roommateId==e[b].id){var i=f.debtorList[g];i.value!=d&&(a.balanced=!1),c+=i.value,a.fields[i.roommateId].field=i.value,a.fields[i.roommateId].disabled=function(){return!a.fields[id].isDebtor},h=!0;break}}0==h&&(a.fields[e[b].id].isDebtor=!1)}a.fields.value.field=c}if(a.shoppingItemList){var j="",l=!0;for(b in a.shoppingItemList)1==l?l=!1:j+=", ",j+=a.shoppingItemList[b].description;var m=k("translateText")("cuTicket.shopping.description",j);m.length>1e3&&(m=m.splice(0,996)+"..."),a.fields.description.field=m;var n=k("translateText")("cuTicket.shopping");a.fields.category.field=n,a.fields.description.focus=null,a.fields.value.focus=function(){return!0}}},a.addWatch=function(b){a.$watch("fields["+b+"].isDebtor",function(){l()}),a.$watch("fields["+b+"].field",function(){l()})},a.$watch("isLoading",function(){}),a.initialize(),a.$watch("fields.value.field",function(){l()});var l=function(){if(a.balanced){var b=0;for(var c in a.roommateList){var d=a.roommateList[c];a.fields[d.id].isDebtor&&b++}var e="";if(a.fields.value.field)var e=a.fields.value.field/b+"";for(var c in a.roommateList){var d=a.roommateList[c];a.fields[d.id].field=a.fields[d.id].isDebtor?e:""}}else{var f=0;for(var c in a.roommateList){var d=a.roommateList[c];if(a.fields[d.id].isDebtor){var g=parseFloat(a.fields[d.id].field);0==isNaN(g)&&(f+=g)}}a.fields.value.field=f+""}};a.save=function(){for(var d in a.fields){var e=a.fields[d];a.fields.hasOwnProperty(d)&&(e.firstAttempt=!1)}if(a.allFieldValid()){var h=[];for(var d in a.roommateList){var i=a.roommateList[d];if(a.fields[i.id].isDebtor&&a.fields[i.id].field){var j={roommateId:i.id,value:a.fields[i.id].field};h.push(j)}}var k={date:a.fields.date.field,description:a.fields.description.field,debtorList:h,payerId:a.mySelf.id,category:a.fields.category.field},l="POST",m="/rest/ticket";if(f&&(l="PUT",m+="/"+f.id),a.loading=!0,b({method:l,url:m,headers:"Content-Type:application/json",data:k}).success(function(b){a.loading=!1,g(b),a.close()}).error(function(b){a.loading=!1,c.error(b.message)}),a.shoppingItemList){var n="";for(d in a.shoppingItemList)n+=a.shoppingItemList[d].id+",";b({method:"PUT",url:"/rest/shoppingItem/wasBought/"+n,headers:"Content-Type:application/json"}).success(function(){}).error(function(a){c.error(a.message)})}}}}]),myApp.controller("CuShoppingItemCtrl",["$scope","$http","$flash","$modalInstance","shoppingItem","addItem","data",function(a,b,c,d,e,f,g){a.onlyForMe=!1,a.loading=!1,a.mySelf=g.mySelf,a.fields={description:{fieldTitle:"generic.description",validationRegex:"[a-zA-Z0-9-]{1,255}",validationMessage:["generic.validation.size","1","255"],focus:function(){return!0},disabled:function(){return a.loading}}},a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.initialize=function(){e&&(a.edit=!0,a.fields.description.field=angular.copy(e.description),a.onlyForMe=angular.copy(e.onlyForMe))},a.initialize(),a.save=function(){for(var d in a.fields){var g=a.fields[d];a.fields.hasOwnProperty(d)&&(g.firstAttempt=!1)}if(a.allFieldValid()){var h,i="POST",j="/rest/shoppingItem";e?(h=e,h.description=a.fields.description.field,h.onlyForMe=a.onlyForMe,i="PUT",j+="/"+e.id):h={description:a.fields.description.field,onlyForMe:a.onlyForMe},a.loading=!0,b({method:i,url:j,headers:"Content-Type:application/json",data:h}).success(function(b){a.loading=!1,f(b),a.close()}).error(function(b){a.loading=!1,c.error(b.message)})}}}]),myApp.controller("HelpModalCtrl",["$scope","$modalInstance","message",function(a,b,c){a.message=c,a.close=function(){b.close()}}]),myApp.controller("ChangeEmailModalCtrl",["$scope","$http","$flash","$modalInstance","roommate","setEmail",function(a,b,c,d,e,f){a.loading=!1,a.fields={oldPassword:{name:"password",fieldTitle:"generic.oldPassword",validationRegex:"^[a-zA-Z0-9-_%]{6,18}$",validationMessage:"generic.validation.password",fieldType:"password",focus:function(){return!0},disabled:function(){return a.loading}},newEmail:{fieldType:"email",name:"email",fieldTitle:"changeEmailModal.email",validationRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,validationMessage:"generic.validation.email",disabled:function(){return a.loading}}},a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.save=function(){for(var d in a.fields){var g=a.fields[d];a.fields.hasOwnProperty(d)&&(g.firstAttempt=!1)}if(a.allFieldValid()){var h={oldPassword:a.fields.oldPassword.field,newEmail:a.fields.newEmail.field};a.loading=!0,b({method:"PUT",url:"/rest/roommate/email/"+e.id,headers:"Content-Type:application/json",data:h}).success(function(b){a.loading=!1,a.close(),f(b.email)}).error(function(b){a.loading=!1,c.error(b.message)})}}}]),myApp.controller("ChangePasswordModalCtrl",["$scope","$http","$flash","$modalInstance","roommate",function(a,b,c,d,e){a.loading=!1,a.fields={oldPassword:{name:"password",fieldTitle:"generic.oldPassword",validationRegex:"^[a-zA-Z0-9-_%]{6,18}$",validationMessage:"generic.validation.password",fieldType:"password",focus:function(){return!0},disabled:function(){return a.loading}},newPassword:{fieldTitle:"changePasswordModal.newPassword",validationRegex:"^[a-zA-Z0-9-_%]{6,18}$",validationMessage:"generic.validation.password",fieldType:"password",disabled:function(){return a.loading}},repeatPassword:{fieldTitle:"generic.repeatPassword",fieldType:"password",validationMessage:"generic.validation.repeatPassword",validation:function(){return a.o.newPassword===a.o.repeatPassword},disabled:function(){return a.loading}}},a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.save=function(){for(var d in a.fields){var f=a.fields[d];a.fields.hasOwnProperty(d)&&(f.firstAttempt=!1)}if(a.allFieldValid()){var g={oldPassword:a.fields.oldPassword.field,newPassword:a.fields.newPassword.field};a.loading=!0,b({method:"PUT",url:"/rest/roommate/password/"+e.id,headers:"Content-Type:application/json",data:g}).success(function(){a.loading=!1,a.close()}).error(function(b){a.loading=!1,c.error(b.message)})}}}]),myApp.controller("CreateFaqModalCtrl",["$scope","$http","$flash","$modalInstance",function(a,b,c,d){a.loading=!1,a.fields={question:{},answer:{}},a.langs=langs;for(var e in langs)lang=langs[e],a.fields.question[lang]={fieldTitle:"faq.question",validationRegex:"^.{1,255}$",validationMessage:"generic.validation.size",focus:function(){return!0},disabled:function(){return a.loading}},a.fields.answer[lang]={fieldTitle:"faq.answer",validationRegex:"^.{1,255}$",validationMessage:"generic.validation.size",disabled:function(){return a.loading}};a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.save=function(){faq={questions:{},answers:{}};for(var d in langs)lang=langs[d],faq.questions[lang]=a.fields.question[lang].field,faq.answers[lang]=a.fields.answer[lang].field;b({method:"POST",url:"/rest/superadmin/faq",headers:"Content-Type:application/json",data:faq}).success(function(){a.loading=!1,a.close()}).error(function(b){a.loading=!1,c.error(b.message)})}}]),myApp.controller("CreateSurveyModalCtrl",["$scope","$http","$flash","$modalInstance",function(a,b,c,d){a.loading=!1,a.fields={questions:{},key:{fieldTitle:"survey key",validationRegex:"^.{1,255}$",validationMessage:"generic.validation.size",focus:function(){return!0},disabled:function(){return a.loading}}},a.langs=langs,a.choices=[];for(var e in langs)lang=langs[e],a.fields.questions[lang]={validationRegex:"^.{1,255}$",validationMessage:"generic.validation.size",disabled:function(){return a.loading}};a.close=function(){d.close()},a.addAnswer=function(){answers={};for(var b in langs)lang=langs[b],answers[lang]={validationRegex:"^.{1,255}$",validationMessage:"generic.validation.size",disabled:function(){return a.loading}};a.choices.push(answers)},a.addAnswer(),a.addAnswer(),a.allFieldValid=function(){for(var b in a.fields.questions){var c=a.fields.questions[b];if(null==c.isValid||c.isValid===!1)return!1}for(var b in a.choices){var d=a.choices[b];for(var e in d){var f=d[e];if(null==f.isValid||f.isValid===!1)return!1}}return!0},a.save=function(){var d={surveyKey:a.fields.key.field,questions:{},answers:[],multipleAnswers:!1};for(var e in a.fields.questions){var f=a.fields.questions[e];d.questions[e]=f.field}for(var g in a.choices){var h=a.choices[g],i={};for(var j in h){var k=h[j];i[j]=k.field}d.answers.push(i)}console.log(d),b({method:"POST",url:"/rest/superadmin/survey",headers:"Content-Type:application/json",data:d}).success(function(){a.loading=!1,a.close()}).error(function(b){a.loading=!1,c.error(b.message)})}}]),myApp.controller("CalculatorModalCtrl",["$scope","$modalInstance","setResult",function(a,b,c){a.input="",a.memory="",a.acceptOperator=!1,a.valid=function(){a.result();var b=parseFloat(a.memory);b&&c(b),a.close()},a.close=function(){b.close()},a.press=function(b){a.input+=b},a.clear=function(){a.input=""},a.clearAll=function(){a.input="",a.memory=""},a.clearLastOne=function(){a.input=a.input.slice(0,a.input.length-1)},a.operation=function(b){parseFloat(a.input)||!isNaN(a.memory)?(a.memory+=a.input+" ",a.memory+=b+" ",a.input=""):a.memory.length>0&&(a.memory=a.memory.slice(0,a.memory.length-2)+b+" ")},a.result=function(){a.memory+=a.input+" ",a.memory=math.eval(a.memory),a.input=""},document.onkeypress=function(b){b=b||window.event,49==b.keyCode?a.press(1):50==b.keyCode?a.press(2):51==b.keyCode?a.press(3):52==b.keyCode?a.press(4):53==b.keyCode?a.press(5):54==b.keyCode?a.press(6):55==b.keyCode?a.press(7):56==b.keyCode?a.press(8):57==b.keyCode?a.press(9):48==b.keyCode?a.press(0):46==b.keyCode||44==b.keyCode?a.press("."):43==b.keyCode?a.operation("+"):47==b.keyCode?a.operation("/"):48==b.keyCode?a.operation("-"):42==b.keyCode?a.operation("*"):63==b.keyCode||13==b.keyCode?a.result():127==b.keyCode&&a.clear(),a.$apply()}}]),myApp.controller("ForgotPasswordModalCtrl",["$scope","$http","$flash","$modalInstance","$filter",function(a,b,c,d,e){a.loading=!1,a.fields={email:{fieldType:"email",name:"email",fieldTitle:"changeEmailModal.email",validationRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,validationMessage:"generic.validation.email",focus:function(){return!0},disabled:function(){return a.loading}}},a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.save=function(){for(var d in a.fields){var f=a.fields[d];a.fields.hasOwnProperty(d)&&(f.firstAttempt=!1)}if(a.allFieldValid()){var g={email:a.fields.email.field};a.loading=!0,b({method:"PUT",url:"/rest/password",headers:"Content-Type:application/json",data:g}).success(function(){a.loading=!1,a.close(),c.success(e("translateText")("forgotPassword.success"))}).error(function(b){a.loading=!1,c.error(b.message)})}}}]),myApp.directive("dirFieldDate",["directiveService","$filter","generateId",function(a,b,c){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/dirFieldDate/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return a.id=c.generate(),a.idHtag="#"+a.id},post:function(c){a.autoScopeImpl(c),c.result=null,c.$watch("result",function(){return c.resultFormated=b("date")(c.result,"yyyy-MM-dd")}),c.$watch("getInfo().field",function(){return null!=c.getInfo().field?c.result=new Date(Number(c.getInfo().field)):void 0}),c.$watch("result",function(){return c.getInfo().field=null!=c.result?c.result.getTime():null,c.isValid()}),c.isValid=function(){var a;return c.getInfo().disabled===!0||c.getInfo().hidden===!0?void(c.getInfo().isValid=!0):(a=!0,null==c.getInfo().field&&(a=!1),void(c.getInfo().isValid=a))},c.isValid(),c.logField=function(){return console.log(c.getInfo())},c.displayError=function(){return 0==c.getInfo().isValid&&c.getInfo().firstAttempt===!1?!0:!1}}}}}}]),myApp.directive("dirFieldText",["directiveService","$timeout","$modal",function(a,b,c){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/dirFieldText/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(b){return a.autoScopeImpl(b)},post:function(d){a.autoScopeImpl(d),void 0==d.getInfo().autoCompleteValue&&(d.getInfo().autoCompleteValue=[]),d.errorMessage="",d.isValidationDefined=null!=d.getInfo().validationRegex||null!=d.getInfo().validationFct,d.hideIsValidIcon=!!d.getInfo().hideIsValidIcon,d.fieldType=null!=d.getInfo().fieldType?d.getInfo().fieldType:"text",null==d.getInfo().field&&(d.getInfo().field=""),null==d.getInfo().isValid&&(d.getInfo().isValid=!d.isValidationDefined),d.isValidationDefined&&d.$watch("getInfo().field",function(a,b){return a!==b?d.isValid():void 0}),d.isValid=function(){var a;return d.getInfo().disabled===!0||d.getInfo().hidden===!0?void(d.getInfo().isValid=!0):(d.getInfo().field||(d.getInfo().field=""),a=!0,"string"!=typeof d.getInfo().field&&(d.getInfo().field+=""),null!=d.getInfo().validationRegex&&(a=null!=d.getInfo().field.match(d.getInfo().validationRegex)),null!=d.getInfo().validationFct&&(a=a&&d.getInfo().validationFct()),void(d.getInfo().isValid=a))},d.isValid(),d.logField=function(){return console.log(d.getInfo())},d.setErrorMessage=function(a){return d.errorMessage=a,null!=d.lastTimeOut&&b.cancel(d.lastTimeOut),d.lastTimeOut=b(function(){return d.errorMessage="",d.lastTimeOut=null},2e3)},d.displayError=function(){return 0==d.getInfo().isValid&&d.getInfo().firstAttempt===!1?!0:!1},d.openCalculator=function(){var a={setResult:function(){return function(a){d.getInfo().field=a}}};c.open({templateUrl:"/assets/javascripts/modal/Calculator/view.html",controller:"CalculatorModalCtrl",size:"sm",resolve:a})}}}}}}]),myApp.directive("dirFieldSelect",["directiveService","$timeout","$modal",function(a,b,c){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/dirFieldSelect/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(b){return a.autoScopeImpl(b)},post:function(d){console.log(d.getInfo().options),a.autoScopeImpl(d),void 0==d.getInfo().autoCompleteValue&&(d.getInfo().autoCompleteValue=[]),d.errorMessage="",d.isValidationDefined=null!=d.getInfo().validationRegex||null!=d.getInfo().validationFct,d.hideIsValidIcon=!!d.getInfo().hideIsValidIcon,d.fieldType=null!=d.getInfo().fieldType?d.getInfo().fieldType:"text",null==d.getInfo().field&&(d.getInfo().field=""),null==d.getInfo().isValid&&(d.getInfo().isValid=!d.isValidationDefined),d.isValidationDefined&&d.$watch("getInfo().field",function(a,b){return a!==b?d.isValid():void 0}),d.isValid=function(){var a;return d.getInfo().disabled===!0||d.getInfo().hidden===!0?void(d.getInfo().isValid=!0):(d.getInfo().field||(d.getInfo().field=""),a=!0,"string"!=typeof d.getInfo().field&&(d.getInfo().field+=""),null!=d.getInfo().validationRegex&&(a=null!=d.getInfo().field.match(d.getInfo().validationRegex)),null!=d.getInfo().validationFct&&(a=a&&d.getInfo().validationFct()),void(d.getInfo().isValid=a))},d.isValid(),d.logField=function(){return console.log(d.getInfo())},d.setErrorMessage=function(a){return d.errorMessage=a,null!=d.lastTimeOut&&b.cancel(d.lastTimeOut),d.lastTimeOut=b(function(){return d.errorMessage="",d.lastTimeOut=null},2e3)},d.displayError=function(){return 0==d.getInfo().isValid&&d.getInfo().firstAttempt===!1?!0:!1
},d.openCalculator=function(){var a={setResult:function(){return function(a){d.getInfo().field=a}}};c.open({templateUrl:"/assets/javascripts/modal/Calculator/view.html",controller:"CalculatorModalCtrl",size:"sm",resolve:a})}}}}}}]),myApp.directive("numbersOnly",["$filter","translationService","$locale",function(a,b,c){return{restrict:"A",require:"ngModel",link:function(b,d,e,f){return b.$watch(e.numbersOnly,function(){var d,g,h,i,j,k,l;return"integer"!==e.numbersOnly&&"double"!==e.numbersOnly&&"percent"!==e.numbersOnly||(b.lastValidValue=0,"integer"===e.numbersOnly?(i=a("translateText")("ONLY_INTEGER"),k=0):(i=a("translateText")("ONLY_NUMBER"),k=2),b.$root.$on("$localeChangeSuccess",function(){var a;return null!=f.$modelValue&&(a=g(parseFloat(f.$modelValue)),null!=a)?(f.$setViewValue(a.toString()),f.$render()):void 0}),f.$parsers.unshift(function(a){var c,g,i;return""===a?null:(c=d(a),isNaN(c)?(h(),b.lastValidValue?(g=b.lastValidValue.toString(),i="percent"===e.numbersOnly?(100*b.lastValidValue).toString():b.lastValidValue.toString()):(g="",i=""),f.$setViewValue(i),f.$render()):("percent"===e.numbersOnly&&(c/=100),b.lastValidValue=c,g=c.toString()),""===g?null:g)}),f.$formatters.unshift(function(a){return b.displayValue(a)}),b.displayValue=function(a){var b;return b=parseFloat(a),"percent"===e.numbersOnly&&(b=100*b),g(b)},h=function(){return null!=b.setErrorMessage?b.setErrorMessage(i):void 0},g=function(a){var b,d;return null==a||isNaN(a)?"":(a=a.toFixed(k),b=c.NUMBER_FORMATS,d=a.toString().replace(new RegExp("\\.","g"),b.DECIMAL_SEP))},d=function(a){var b,d,e;return""===a?0/0:(d=c.NUMBER_FORMATS,b=d.DECIMAL_SEP,"."===b&&(b="\\."),e=a.replace(new RegExp(b,"g"),"."),j(e))},j=function(a){var b;return a.isNaN?0/0:(b=new RegExp("integer"===e.numbersOnly?"^(\\-|\\+)?([0-9]+|Infinity)?$":"^(\\-|\\+)?([0-9]+(\\.[0-9]*)?|Infinity)?$"),b.test(a)?Number(a):0/0)},null==f.$modelValue)?void 0:(b.lastValidValue=parseFloat(f.$modelValue),l=b.displayValue(b.lastValidValue),f.$setViewValue(l),f.$render())})}}}]),myApp.directive("dirUserIcon",["directiveService","$filter","generateId",function(a){return{restrict:"E",scope:a.autoScope({ngUser:"=",ngLittle:"="}),templateUrl:"/assets/javascripts/directive/dirUserIcon/template.html",replace:!0,transclude:!0,link:function(b){a.autoScopeImpl(b),b.getName=function(){return b.getUser().nameAbrv},b.getColor=function(){return b.getUser().iconColor}}}}]),myApp.directive("dirFocusMe",["$timeout","$parse",function(){return{restrict:"A",scope:{dirFocusMe:"="},link:function(a,b){a.$watch("dirFocusMe",function(){return a.dirFocusMe===!0?b[0].focus():void 0})}}}]),myApp.directive("dirEnter",function(){return function(a,b,c){return b.bind("keydown keypress",function(b){return 13===b.which?(a.$apply(function(){return a.$eval(c.dirEnter)}),b.preventDefault()):void 0})}}),myApp.service("$flash",["$filter",function(){Messenger.options={extraClasses:"messenger-fixed messenger-on-top messenger-on-center cr-messenger",theme:"block"},this.success=function(a){for(var b in a.split("\n")){var c=a.split("\n")[b];Messenger().post({message:c,type:"success",showCloseButton:!0})}},this.info=function(a){for(var b in a.split("\n")){var c=a.split("\n")[b];Messenger().post({message:c,type:"info",showCloseButton:!0})}},this.error=function(a){for(var b in a.split("\n")){var c=a.split("\n")[b];Messenger().post({message:c,type:"error",showCloseButton:!0})}},this.warning=function(a){for(var b in a.split("\n")){var c=a.split("\n")[b];Messenger().post({message:c,type:"warning",showCloseButton:!0})}}}]),myApp.service("directiveService",["$sce",function(a){this.autoScope=function(a){var b,c,d;c={};for(b in a)d=a[b],c[b]=d,"ng"===b.slice(0,2)&&"="===d&&(c[b[2].toLowerCase()+b.slice(3)]="@");return c},this.autoScopeImpl=function(b,c){var d,e,f;b.$$NAME=c;for(e in b)f=b[e],"ng"===e.slice(0,2)&&(d=function(a,b){return function(){var c;return c=0,c=void 0===a[b]||null===a[b]||""===a[b]?a[b[2].toLowerCase()+b.slice(3)]:a[b],a["decorate"+b.slice(2)]?a["decorate"+b.slice(2)](c):c}},b["get"+e.slice(2)]=d(b,e));return b.isTrue=function(a){return a===!0||"true"===a||"y"===a},b.isFalse=function(a){return a===!1||"false"===a||"n"===a},b.isNull=function(a){return null===a},b.html=function(b){return a.trustAsHtml(b)}}}]),myApp.service("generateId",["$rootScope",function(){this.generate=function(){var a,b,c;for(c="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;20>a;)c+=b.charAt(Math.floor(Math.random()*b.length)),a++;return c}}]),myApp.service("translationService",["$rootScope","$filter","$http","$locale",function(a,b){var c;c=this,c.elements=null,c.set=function(a){c.elements=a.translations},c.get=function(a){return c.elements[a]?c.elements[a]:a},c.translateExceptionsDTO=function(a){return null!=a.params&&Object.keys(a.params).length>0?b("translateTextWithVars")(a.messageToTranslate,a.params):null!=a.messageToTranslate?b("translate")(a.messageToTranslate):a.message}}]),myApp.filter("translateText",["$sce","translationService",function(a,b){return function(a,c){var d;if("object"==typeof a){d=b.get(a[0]);for(var e in a)0!=e&&(d=d.replace("{"+(parseFloat(e)-1)+"}",a[e]));return d}if(d=b.get(a),null!=c)if("array"==typeof c)for(var e in c)d=d.replace("{"+e+"}",c[e]);else d=d.replace("{0}",c);return d}}]),function(a){function b(b){return!b||void 0!==b.allowPageScroll||void 0===b.swipe&&void 0===b.swipeStatus||(b.allowPageScroll=j),void 0!==b.click&&void 0===b.tap&&(b.tap=b.click),b||(b={}),b=a.extend({},a.fn.swipe.defaults,b),this.each(function(){var d=a(this),e=d.data(z);e||(e=new c(this,b),d.data(z,e))})}function c(b,c){function A(b){if(!(hb()||a(b.target).closest(c.excludedElements,Qb).length>0)){var d,e=b.originalEvent?b.originalEvent:b,f=y?e.touches[0]:e;return Rb=u,y?Sb=e.touches.length:b.preventDefault(),Hb=0,Ib=null,Ob=null,Jb=0,Kb=0,Lb=0,Mb=1,Nb=0,Tb=mb(),Pb=pb(),fb(),!y||Sb===c.fingers||c.fingers===s||P()?(jb(0,f),Ub=yb(),2==Sb&&(jb(1,e.touches[1]),Kb=Lb=sb(Tb[0].start,Tb[1].start)),(c.swipeStatus||c.pinchStatus)&&(d=H(e,Rb))):d=!1,d===!1?(Rb=x,H(e,Rb),d):void ib(!0)}}function B(a){var b=a.originalEvent?a.originalEvent:a;if(Rb!==w&&Rb!==x&&!gb()){var d,e=y?b.touches[0]:b,f=kb(e);if(Vb=yb(),y&&(Sb=b.touches.length),Rb=v,2==Sb&&(0==Kb?(jb(1,b.touches[1]),Kb=Lb=sb(Tb[0].start,Tb[1].start)):(kb(b.touches[1]),Lb=sb(Tb[0].end,Tb[1].end),Ob=ub(Tb[0].end,Tb[1].end)),Mb=tb(Kb,Lb),Nb=Math.abs(Kb-Lb)),Sb===c.fingers||c.fingers===s||!y||P()){if(Ib=xb(f.start,f.end),N(a,Ib),Hb=vb(f.start,f.end),Jb=rb(),nb(Ib,Hb),(c.swipeStatus||c.pinchStatus)&&(d=H(b,Rb)),!c.triggerOnTouchEnd||c.triggerOnTouchLeave){var g=!0;if(c.triggerOnTouchLeave){var h=zb(this);g=Ab(f.end,h)}!c.triggerOnTouchEnd&&g?Rb=G(v):c.triggerOnTouchLeave&&!g&&(Rb=G(w)),(Rb==x||Rb==w)&&H(b,Rb)}}else Rb=x,H(b,Rb);d===!1&&(Rb=x,H(b,Rb))}}function C(a){var b=a.originalEvent;return y&&b.touches.length>0?(eb(),!0):(gb()&&(Sb=Xb),a.preventDefault(),Vb=yb(),Jb=rb(),K()?(Rb=x,H(b,Rb)):c.triggerOnTouchEnd||0==c.triggerOnTouchEnd&&Rb===v?(Rb=w,H(b,Rb)):!c.triggerOnTouchEnd&&W()?(Rb=w,I(b,Rb,n)):Rb===v&&(Rb=x,H(b,Rb)),void ib(!1))}function D(){Sb=0,Vb=0,Ub=0,Kb=0,Lb=0,Mb=1,fb(),ib(!1)}function E(a){var b=a.originalEvent;c.triggerOnTouchLeave&&(Rb=G(w),H(b,Rb))}function F(){Qb.unbind(Cb,A),Qb.unbind(Gb,D),Qb.unbind(Db,B),Qb.unbind(Eb,C),Fb&&Qb.unbind(Fb,E),ib(!1)}function G(a){var b=a,d=M(),e=J(),f=K();return!d||f?b=x:!e||a!=v||c.triggerOnTouchEnd&&!c.triggerOnTouchLeave?!e&&a==w&&c.triggerOnTouchLeave&&(b=x):b=w,b}function H(a,b){var c=void 0;return T()||S()?c=I(a,b,l):(Q()||P())&&c!==!1&&(c=I(a,b,m)),cb()&&c!==!1?c=I(a,b,o):db()&&c!==!1?c=I(a,b,p):bb()&&c!==!1&&(c=I(a,b,n)),b===x&&D(a),b===w&&(y?0==a.touches.length&&D(a):D(a)),c}function I(b,j,k){var q=void 0;if(k==l){if(Qb.trigger("swipeStatus",[j,Ib||null,Hb||0,Jb||0,Sb]),c.swipeStatus&&(q=c.swipeStatus.call(Qb,b,j,Ib||null,Hb||0,Jb||0,Sb),q===!1))return!1;if(j==w&&R()){if(Qb.trigger("swipe",[Ib,Hb,Jb,Sb]),c.swipe&&(q=c.swipe.call(Qb,b,Ib,Hb,Jb,Sb),q===!1))return!1;switch(Ib){case d:Qb.trigger("swipeLeft",[Ib,Hb,Jb,Sb]),c.swipeLeft&&(q=c.swipeLeft.call(Qb,b,Ib,Hb,Jb,Sb));break;case e:Qb.trigger("swipeRight",[Ib,Hb,Jb,Sb]),c.swipeRight&&(q=c.swipeRight.call(Qb,b,Ib,Hb,Jb,Sb));break;case f:Qb.trigger("swipeUp",[Ib,Hb,Jb,Sb]),c.swipeUp&&(q=c.swipeUp.call(Qb,b,Ib,Hb,Jb,Sb));break;case g:Qb.trigger("swipeDown",[Ib,Hb,Jb,Sb]),c.swipeDown&&(q=c.swipeDown.call(Qb,b,Ib,Hb,Jb,Sb))}}}if(k==m){if(Qb.trigger("pinchStatus",[j,Ob||null,Nb||0,Jb||0,Sb,Mb]),c.pinchStatus&&(q=c.pinchStatus.call(Qb,b,j,Ob||null,Nb||0,Jb||0,Sb,Mb),q===!1))return!1;if(j==w&&O())switch(Ob){case h:Qb.trigger("pinchIn",[Ob||null,Nb||0,Jb||0,Sb,Mb]),c.pinchIn&&(q=c.pinchIn.call(Qb,b,Ob||null,Nb||0,Jb||0,Sb,Mb));break;case i:Qb.trigger("pinchOut",[Ob||null,Nb||0,Jb||0,Sb,Mb]),c.pinchOut&&(q=c.pinchOut.call(Qb,b,Ob||null,Nb||0,Jb||0,Sb,Mb))}}return k==n?(j===x||j===w)&&(clearTimeout(Zb),X()&&!$()?(Yb=yb(),Zb=setTimeout(a.proxy(function(){Yb=null,Qb.trigger("tap",[b.target]),c.tap&&(q=c.tap.call(Qb,b,b.target))},this),c.doubleTapThreshold)):(Yb=null,Qb.trigger("tap",[b.target]),c.tap&&(q=c.tap.call(Qb,b,b.target)))):k==o?(j===x||j===w)&&(clearTimeout(Zb),Yb=null,Qb.trigger("doubletap",[b.target]),c.doubleTap&&(q=c.doubleTap.call(Qb,b,b.target))):k==p&&(j===x||j===w)&&(clearTimeout(Zb),Yb=null,Qb.trigger("longtap",[b.target]),c.longTap&&(q=c.longTap.call(Qb,b,b.target))),q}function J(){var a=!0;return null!==c.threshold&&(a=Hb>=c.threshold),a}function K(){var a=!1;return null!==c.cancelThreshold&&null!==Ib&&(a=ob(Ib)-Hb>=c.cancelThreshold),a}function L(){return null!==c.pinchThreshold?Nb>=c.pinchThreshold:!0}function M(){var a;return a=c.maxTimeThreshold&&Jb>=c.maxTimeThreshold?!1:!0}function N(a,b){if(c.allowPageScroll===j||P())a.preventDefault();else{var h=c.allowPageScroll===k;switch(b){case d:(c.swipeLeft&&h||!h&&c.allowPageScroll!=q)&&a.preventDefault();break;case e:(c.swipeRight&&h||!h&&c.allowPageScroll!=q)&&a.preventDefault();break;case f:(c.swipeUp&&h||!h&&c.allowPageScroll!=r)&&a.preventDefault();break;case g:(c.swipeDown&&h||!h&&c.allowPageScroll!=r)&&a.preventDefault()}}}function O(){var a=U(),b=V(),c=L();return a&&b&&c}function P(){return!!(c.pinchStatus||c.pinchIn||c.pinchOut)}function Q(){return!(!O()||!P())}function R(){var a=M(),b=J(),c=U(),d=V(),e=K(),f=!e&&d&&c&&b&&a;return f}function S(){return!!(c.swipe||c.swipeStatus||c.swipeLeft||c.swipeRight||c.swipeUp||c.swipeDown)}function T(){return!(!R()||!S())}function U(){return Sb===c.fingers||c.fingers===s||!y}function V(){return 0!==Tb[0].end.x}function W(){return!!c.tap}function X(){return!!c.doubleTap}function Y(){return!!c.longTap}function Z(){if(null==Yb)return!1;var a=yb();return X()&&a-Yb<=c.doubleTapThreshold}function $(){return Z()}function _(){return!(1!==Sb&&y||!isNaN(Hb)&&0!==Hb)}function ab(){return Jb>c.longTapThreshold&&t>Hb}function bb(){return!(!_()||!W())}function cb(){return!(!Z()||!X())}function db(){return!(!ab()||!Y())}function eb(){Wb=yb(),Xb=event.touches.length+1}function fb(){Wb=0,Xb=0}function gb(){var a=!1;if(Wb){var b=yb()-Wb;b<=c.fingerReleaseThreshold&&(a=!0)}return a}function hb(){return!(Qb.data(z+"_intouch")!==!0)}function ib(a){a===!0?(Qb.bind(Db,B),Qb.bind(Eb,C),Fb&&Qb.bind(Fb,E)):(Qb.unbind(Db,B,!1),Qb.unbind(Eb,C,!1),Fb&&Qb.unbind(Fb,E,!1)),Qb.data(z+"_intouch",a===!0)}function jb(a,b){var c=void 0!==b.identifier?b.identifier:0;return Tb[a].identifier=c,Tb[a].start.x=Tb[a].end.x=b.pageX||b.clientX,Tb[a].start.y=Tb[a].end.y=b.pageY||b.clientY,Tb[a]}function kb(a){var b=void 0!==a.identifier?a.identifier:0,c=lb(b);return c.end.x=a.pageX||a.clientX,c.end.y=a.pageY||a.clientY,c}function lb(a){for(var b=0;b<Tb.length;b++)if(Tb[b].identifier==a)return Tb[b]}function mb(){for(var a=[],b=0;5>=b;b++)a.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return a}function nb(a,b){b=Math.max(b,ob(a)),Pb[a].distance=b}function ob(a){return Pb[a].distance}function pb(){var a={};return a[d]=qb(d),a[e]=qb(e),a[f]=qb(f),a[g]=qb(g),a}function qb(a){return{direction:a,distance:0}}function rb(){return Vb-Ub}function sb(a,b){var c=Math.abs(a.x-b.x),d=Math.abs(a.y-b.y);return Math.round(Math.sqrt(c*c+d*d))}function tb(a,b){var c=b/a*1;return c.toFixed(2)}function ub(){return 1>Mb?i:h}function vb(a,b){return Math.round(Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2)))}function wb(a,b){var c=a.x-b.x,d=b.y-a.y,e=Math.atan2(d,c),f=Math.round(180*e/Math.PI);return 0>f&&(f=360-Math.abs(f)),f}function xb(a,b){var c=wb(a,b);return 45>=c&&c>=0?d:360>=c&&c>=315?d:c>=135&&225>=c?e:c>45&&135>c?g:f}function yb(){var a=new Date;return a.getTime()}function zb(b){b=a(b);var c=b.offset(),d={left:c.left,right:c.left+b.outerWidth(),top:c.top,bottom:c.top+b.outerHeight()};return d}function Ab(a,b){return a.x>b.left&&a.x<b.right&&a.y>b.top&&a.y<b.bottom}var Bb=y||!c.fallbackToMouseEvents,Cb=Bb?"touchstart":"mousedown",Db=Bb?"touchmove":"mousemove",Eb=Bb?"touchend":"mouseup",Fb=Bb?null:"mouseleave",Gb="touchcancel",Hb=0,Ib=null,Jb=0,Kb=0,Lb=0,Mb=1,Nb=0,Ob=0,Pb=null,Qb=a(b),Rb="start",Sb=0,Tb=null,Ub=0,Vb=0,Wb=0,Xb=0,Yb=0,Zb=null;try{Qb.bind(Cb,A),Qb.bind(Gb,D)}catch($b){a.error("events not supported "+Cb+","+Gb+" on jQuery.swipe")}this.enable=function(){return Qb.bind(Cb,A),Qb.bind(Gb,D),Qb},this.disable=function(){return F(),Qb},this.destroy=function(){return F(),Qb.data(z,null),Qb},this.option=function(b,d){if(void 0!==c[b]){if(void 0===d)return c[b];c[b]=d}else a.error("Option "+b+" does not exist on jQuery.swipe.options")}}var d="left",e="right",f="up",g="down",h="in",i="out",j="none",k="auto",l="swipe",m="pinch",n="tap",o="doubletap",p="longtap",q="horizontal",r="vertical",s="all",t=10,u="start",v="move",w="end",x="cancel",y="ontouchstart"in window,z="TouchSwipe",A={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"button, input, select, textarea, a, .noSwipe"};a.fn.swipe=function(c){var d=a(this),e=d.data(z);if(e&&"string"==typeof c){if(e[c])return e[c].apply(this,Array.prototype.slice.call(arguments,1));a.error("Method "+c+" does not exist on jQuery.swipe")}else if(!(e||"object"!=typeof c&&c))return b.apply(this,arguments);return d},a.fn.swipe.defaults=A,a.fn.swipe.phases={PHASE_START:u,PHASE_MOVE:v,PHASE_END:w,PHASE_CANCEL:x},a.fn.swipe.directions={LEFT:d,RIGHT:e,UP:f,DOWN:g,IN:h,OUT:i},a.fn.swipe.pageScroll={NONE:j,HORIZONTAL:q,VERTICAL:r,AUTO:k},a.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:s}}(jQuery),$(document).ready(function(){var a=50;$("#sidebar-toggle").click(function(){$(".global-container").toggleClass("open-sidebar")}),$(".swipe-area").swipe({swipeStatus:function(a,b,c){return"move"==b&&"right"==c?($(".global-container").addClass("open-sidebar"),!1):"move"==b&&"left"==c?($(".global-container").removeClass("open-sidebar"),!1):void 0}}),$(".large-menu").css("width",$(".main-container").width()),$(window).resize(function(){$(".large-menu").css("width",$(".main-container").width()),$(window).width()>992&&$(".global-container").hasClass("open-sidebar")&&$(".global-container").removeClass("open-sidebar")}),$(".main-body").scroll(function(){$(".main-body").scrollTop()>a?($(".large-menu").css("position","fixed"),$(".large-menu").css("top","0")):$(".large-menu").css("position","relative")})});