angular.module("tmh.dynamicLocale").config(["tmhDynamicLocaleProvider",function(a){a.localeLocationPattern("/assets/components/angular-i18n/angular-locale_{{locale}}.js")}]);var myApp=angular.module("app",["ui.bootstrap.datetimepicker","ui.bootstrap","angucomplete","tmh.dynamicLocale"]);myApp.controller("MainCtrl",["$scope","$locale","tmhDynamicLocale","translationService",function(a,b,c,d){"data"in window&&void 0!=data&&null!=data&&(c.set(data.langId),d.set(data.translations)),a.helpDisplayed=!1,a.displayHelp=function(){a.helpDisplayed=!0}}]),myApp.controller("HomeCtrl",["$scope","$modal",function(a,b){a.mySelf=data.mySelf,a.moneySymbol=data.home.moneySymbol,a.ticketList=ticketList,a.shoppingItemList=shoppingItemList,a.roommateList=data.roommateList,a.moneySymbol=data.home.moneySymbol,a.sortTicketList=function(){a.shoppingItemList=_.sortBy(a.shoppingItemList,function(a){return-a.creationDate})},a.sortTicketList(),a.computeCountBalance=function(){var b=0,c=0;for(var d in a.ticketList)for(var e in a.ticketList[d].debtorList)a.ticketList[d].payerId==a.mySelf.id&&(b+=a.ticketList[d].debtorList[e].value),a.ticketList[d].debtorList[e].roommateId==a.mySelf.id&&(c+=a.ticketList[d].debtorList[e].value);return b-c},a.getTotalItemSelected=function(){var b=0;for(var c in a.shoppingItemList)a.shoppingItemList[c].selected&&1==a.shoppingItemList[c].selected&&b++;return b},a.addItem=function(b){a.ticketList.push(b);for(var c=a.shoppingItemList.length-1;c>=0;c--)a.shoppingItemList[c].selected&&1==a.shoppingItemList[c].selected&&a.shoppingItemList.splice(c,1)},a.resolveSelectedItem=function(){var c=[];for(var d in a.shoppingItemList)a.shoppingItemList[d].selected&&1==a.shoppingItemList[d].selected&&c.push(a.shoppingItemList[d]);var e=[];for(var d in a.ticketList)a.ticketList[d].category&&0==_.contains(e,a.ticketList[d].category)&&e.push(a.ticketList[d].category);var f={roommateList:function(){return roommateList},ticket:function(){return null},addItem:function(){return a.addItem},categoryList:function(){return e},moneySymbol:function(){return a.moneySymbol},shoppingItemList:function(){return c}};b.open({templateUrl:"/assets/javascripts/modal/CUTicket/view.html",controller:"CuTicketCtrl",size:"lg",resolve:f})},a.createTicket=function(){var c=[];for(var d in a.ticketList)a.ticketList[d].category&&0==_.contains(c,a.ticketList[d].category)&&c.push(a.ticketList[d].category);var e={roommateList:function(){return roommateList},ticket:function(){return null},addItem:function(){return function(b){a.ticketList.push(b)}},categoryList:function(){return c},moneySymbol:function(){return a.moneySymbol},shoppingItemList:function(){return null}};b.open({templateUrl:"/assets/javascripts/modal/CUTicket/view.html",controller:"CuTicketCtrl",size:"lg",resolve:e})},a.createShoppingItem=function(){var c={shoppingItem:function(){return null},addItem:function(){return function(b){a.shoppingItemList.push(b),a.sortTicketList()}},data:function(){return data}};b.open({templateUrl:"/assets/javascripts/modal/CUShoppingItem/view.html",controller:"CuShoppingItemCtrl",size:"lg",resolve:c})}}]),myApp.controller("AdminRoommateListCtrl",["$scope","$http","$flash","translationService","$locale",function(a,b,c){a.roommateList=initialData,a.moneySymbol=data.home.moneySymbol,a.edit=function(a){a.edit=!a.edit},a.remove=function(d){if(d.id)d.isLoading=!0,b({method:"DELETE",url:"/rest/roommate/"+d.id,headers:"Content-Type:application/json"}).success(function(){for(var b=0;b<a.roommateList.length;b++)a.roommateList[b]==d&&a.roommateList.splice(b,1);d.isLoading=!1}).error(function(a){c.error(a.message),d.isLoading=!1});else for(var e=0;e<a.roommateList.length;e++)a.roommateList[e]==d&&a.roommateList.splice(e,1)},a.save=function(d){var e="",f="/rest/roommate";null!=d.id&&void 0!=d.id?(e="PUT",f+="/"+d.id):e="POST",d.isLoading=!0,b({method:e,url:f,headers:"Content-Type:application/json",data:d}).success(function(b){for(var c=0;c<a.roommateList.length;c++)a.roommateList[c]==d&&a.roommateList.splice(c,1,b);d.edit=!1,d.isLoading=!1}).error(function(a){c.error(a.message),null!=d.id&&(d.edit=!1),d.isLoading=!1})},a.add=function(){a.roommateList.push({id:null,nameAbrv:"",name:"",email:"",edit:!0})}}]),myApp.controller("LateralMenuCtrl",["$scope",function(a){a.itemOpen=[],a.switchVisibility=function(b){a.itemOpen[b]=!a.menuItemOpen(b)},a.menuItemOpen=function(b){return void 0==a.itemOpen[b]||0==a.itemOpen[b]?!1:!0}}]),myApp.controller("CountResumeCtrl",["$scope","$http","$flash","$modal","translationService","$locale",function(a){a.ticketList=ticketList.list,a.moneySymbol=data.home.moneySymbol,a.countResumeList=_.sortBy(countResumeList.list,function(a){return a.roommate.id}),a.sub=function(a,b){return a-b},a.totalSpend=function(){var b=0;for(var c in a.countResumeList)b+=a.countResumeList[c].spend;return b},a.totalDept=function(){var b=0;for(var c in a.countResumeList)b+=a.countResumeList[c].dept;return b},a.computeResult=function(){var b=[];for(var c in a.countResumeList){var d=a.countResumeList[c].roommate,e={roommate:d,payed:0,mustPay:0};for(var f in a.ticketList){var g=a.ticketList[f];for(var h in g.debtorList)g.payerId==d.id&&(e.payed+=g.debtorList[h].value),g.debtorList[h].roommateId==d.id&&(e.mustPay+=g.debtorList[h].value)}e.resetToReceive=e.payed-e.mustPay,b.push(e)}a.balanceList=[];for(c in b){var e=b[c],i=e.payed-e.mustPay;if(0>i)for(f in b){var j=b[f];if(j.resetToReceive>0){var k=null;for(h in a.balanceList)balanceToFind=a.balanceList[h],balanceToFind.from.id==e.roommate.id&&balanceToFind.to.id==j.roommate.id&&(k=balanceToFind);if(null==k&&(k={},k.from=e.roommate,k.to=j.roommate,k.value=0),a.balanceList.push(k),j.resetToReceive>=Math.abs(i)){k.value+=Math.abs(i),j.resetToReceive-=Math.abs(i);break}k.value+=j.resetToReceive,i+=j.resetToReceive,j.resetToReceive=0}}}},a.computeResult()}]),myApp.controller("CountTicketCtrl",["$scope","$http","$flash","$modal","translationService","$locale","tmhDynamicLocale",function(a,b,c,d){a.myself=data.mySelf,a.moneySymbol=data.home.moneySymbol,a.ticketList=ticketList.list,a.sortSelection=[{ref:"date",label:"count.ticket.sort.date"},{ref:"category",label:"count.ticket.sort.category"},{ref:"payer",label:"count.ticket.sort.payer"}],a.sortOption="date";for(var e in a.ticketList)a.ticketList[e].debtorList=_.sortBy(a.ticketList[e].debtorList,function(a){return a.roommateId});a.sort=function(){a.sortBy(a.sortOption)},a.sortBy=function(b){a.ticketList=_.sortBy(a.ticketList,function(a){return"payer"==b?a.payerId:"category"==b?a.category:"date"==b?-a.date:void 0})},a.sort(),a.$watch("sortOption",function(b,c){b!=c&&a.sortBy(a.sortOption)}),a.getRoommate=function(a){for(var b in roommateList)if(roommateList[b].id==a)return roommateList[b];return null},a.addItem=function(b){for(var c in a.ticketList)if(a.ticketList[c].id==b.id)return void a.ticketList.splice(c,1,b);a.ticketList.push(b),a.sort()},a.remove=function(d){d.isLoading=!0,b({method:"DELETE",url:"/rest/ticket/"+d.id,headers:"Content-Type:application/json"}).success(function(){d.isLoading=!1;for(var b in a.ticketList)a.ticketList[b].id==d.id&&a.ticketList.splice(b,1)}).error(function(a){d.isLoading=!1,c.error(a.message)})},a.getGlobalValue=function(a){var b=0;for(var c in a.debtorList)b+=a.debtorList[c].value;return b},a.createOrEditTicket=function(b){var c=[];for(var e in a.ticketList)a.ticketList[e].category&&0==_.contains(c,a.ticketList[e].category)&&c.push(a.ticketList[e].category);var f={roommateList:function(){return roommateList},ticket:function(){return b},addItem:function(){return a.addItem},categoryList:function(){return c},moneySymbol:function(){return a.moneySymbol},shoppingItemList:function(){return null}};d.open({templateUrl:"/assets/javascripts/modal/CUTicket/view.html",controller:"CuTicketCtrl",size:"lg",resolve:f})}}]),myApp.controller("ProfileMyProfileCtrl",["$scope","$http","$flash","$modal","translationService",function(a,b,c,d){a.roommate=data.mySelf,a.moneySymbol=data.home.moneySymbol,a.loading=!1,a.fields={name:{fieldTitle:"generic.yourName",validationRegex:"^[a-zA-Z0-9-_%]{1,50}$",validationMessage:["generic.validation.size","1","50"],field:a.roommate.name,focus:function(){return!0},disabled:function(){return a.loading}},nameAbrv:{fieldTitle:"generic.yourNameAbrv",validationRegex:"^[a-zA-Z0-9-_%]{1,3}$",validationMessage:["generic.validation.size","1","3"],field:a.roommate.nameAbrv,disabled:function(){return a.loading}}},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.changePassword=function(){var b={roommate:function(){return a.roommate}};d.open({templateUrl:"/assets/javascripts/modal/ChangePassword/view.html",controller:"ChangePasswordModalCtrl",size:"lg",resolve:b})},a.setEmail=function(b){a.roommate.email=b},a.changeEmail=function(){var b={roommate:function(){return a.roommate},setEmail:function(){return a.setEmail}};d.open({templateUrl:"/assets/javascripts/modal/ChangeEmail/view.html",controller:"ChangeEmailModalCtrl",size:"lg",resolve:b})},a.save=function(){if(a.allFieldValid()){var d={name:a.fields.name.field,nameAbrv:a.fields.nameAbrv.field};a.loading=!0,b({method:"PUT",url:"/rest/roommate/"+a.roommate.id,headers:"Content-Type:application/json",data:d}).success(function(){a.loading=!1,a.close()}).error(function(b){a.loading=!1,c.error(b.message)})}}}]),myApp.controller("ShoppingListCtrl",["$scope","$http","$flash","$modal","translationService","$locale","tmhDynamicLocale",function(a,b,c,d){a.myself=data.mySelf,a.shoppingItemList=shoppingItemList.list,a.sortSelection=[{ref:"date",label:"generic.date"},{ref:"creator",label:"generic.creator"}],a.sortOption="date",a.sort=function(){a.sortBy(a.sortOption)},a.sortBy=function(b){a.shoppingItemList=_.sortBy(a.shoppingItemList,function(a){return"creator"==b?a.creatorId:"date"==b?-a.creationDate:void 0})},a.sort(),a.$watch("sortOption",function(b,c){b!=c&&a.sortBy(a.sortOption)}),a.getRoommate=function(a){for(var b in roommateList)if(roommateList[b].id==a)return roommateList[b];return null},a.addItem=function(b){for(var c in a.shoppingItemList)if(a.shoppingItemList[c].id==b.id)return void a.shoppingItemList.splice(c,1,b);a.shoppingItemList.push(b),a.sort()},a.remove=function(d){d.isLoading=!0,b({method:"DELETE",url:"/rest/shoppingItem/"+d.id,headers:"Content-Type:application/json"}).success(function(){d.isLoading=!1;for(var b in a.shoppingItemList)a.shoppingItemList[b].id==d.id&&a.shoppingItemList.splice(b,1)}).error(function(a){d.isLoading=!1,c.error(a.message)})},a.createOrEditShoppingItem=function(b){var c={shoppingItem:function(){return b},addItem:function(){return a.addItem},data:function(){return data}};d.open({templateUrl:"/assets/javascripts/modal/CUShoppingItem/view.html",controller:"CuShoppingItemCtrl",size:"lg",resolve:c})}}]),myApp.controller("RegistrationCtrl",["$scope",function(a){a.nameAbrv="",a.name="",a.$watch("name",function(){a.nameAbrv=a.name.slice(0,3)})}]),myApp.controller("AboutCtrl",["$scope","$modal",function(a,b){a.openCalculator=function(){var a={setResult:function(){return function(a){scope.getInfo().field=a}}};b.open({templateUrl:"/assets/javascripts/modal/Calculator/view.html",controller:"CalculatorModalCtrl",size:"sm",resolve:a})}}]),myApp.controller("CuTicketCtrl",["$scope","$http","$flash","$modalInstance","roommateList","ticket","addItem","categoryList","moneySymbol","shoppingItemList","$filter","$modal",function(a,b,c,d,e,f,g,h,i,j,k){a.roommateList=e,a.balanced=!0,a.categoryList=h,a.loading=!1,a.mySelf=data.mySelf,a.money=i,a.shoppingItemList=j,a.fields={description:{fieldTitle:"generic.description",validationRegex:"[a-zA-Z0-9-]{1,255}",validationMessage:["generic.validation.size","1","255"],focus:function(){return!0},disabled:function(){return a.loading}},date:{fieldTitle:"generic.date",validationMessage:"generic.validation.date",field:new Date,disabled:function(){return a.loading}},value:{fieldTitle:"generic.total",validationRegex:".+",validationMessage:"generic.validation.notNull",numbersOnly:"double",hasCalculator:!0,disabled:function(){return a.loading||!a.balanced},money:a.money},category:{fieldTitle:"generic.category",autoCompleteValue:h,disabled:function(){return a.loading}}},a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.initialize=function(){for(var b in a.roommateList)roommate=a.roommateList[b],a.fields[roommate.id]={numbersOnly:"double",field:"",isDebtor:!0,isValid:!0},a.addWatch(roommate.id);if(f){a.edit=!0,a.fields.description.field=angular.copy(f.description),a.fields.date.field=angular.copy(f.date),a.fields.category.field=angular.copy(f.category);var c=0,d=f.debtorList[0].value;for(var b in e){for(var g in f.debtorList){var h=!1;if(f.debtorList[g].roommateId==e[b].id){var i=f.debtorList[g];i.value!=d&&(a.balanced=!1),c+=i.value,a.fields[i.roommateId].field=i.value,a.fields[i.roommateId].disabled=function(){return!a.fields[id].isDebtor},h=!0;break}}0==h&&(a.fields[e[b].id].isDebtor=!1)}a.fields.value.field=c}if(a.shoppingItemList){var j="",l=!0;for(b in a.shoppingItemList)1==l?l=!1:j+=", ",j+=a.shoppingItemList[b].description;var m=k("translateText")("cuTicket.shopping.description",j);m.length>1e3&&(m=m.splice(0,996)+"..."),a.fields.description.field=m;var n=k("translateText")("cuTicket.shopping");a.fields.category.field=n,a.fields.description.focus=null,a.fields.value.focus=function(){return!0}}},a.addWatch=function(b){a.$watch("fields["+b+"].isDebtor",function(){l()}),a.$watch("fields["+b+"].field",function(){l()})},a.$watch("isLoading",function(){}),a.initialize(),a.$watch("fields.value.field",function(){l()});var l=function(){if(a.balanced){var b=0;for(var c in a.roommateList){var d=a.roommateList[c];a.fields[d.id].isDebtor&&b++}var e="";if(a.fields.value.field)var e=a.fields.value.field/b+"";for(var c in a.roommateList){var d=a.roommateList[c];a.fields[d.id].field=a.fields[d.id].isDebtor?e:""}}else{var f=0;for(var c in a.roommateList){var d=a.roommateList[c];if(a.fields[d.id].isDebtor){var g=parseFloat(a.fields[d.id].field);0==isNaN(g)&&(f+=g)}}a.fields.value.field=f+""}};a.save=function(){for(var d in a.fields){var e=a.fields[d];a.fields.hasOwnProperty(d)&&(e.firstAttempt=!1)}if(a.allFieldValid()){var h=[];for(var d in a.roommateList){var i=a.roommateList[d];if(a.fields[i.id].isDebtor&&a.fields[i.id].field){var j={roommateId:i.id,value:a.fields[i.id].field};h.push(j)}}var k={date:a.fields.date.field,description:a.fields.description.field,debtorList:h,payerId:a.mySelf.id,category:a.fields.category.field},l="POST",m="/rest/ticket";if(f&&(l="PUT",m+="/"+f.id),a.loading=!0,b({method:l,url:m,headers:"Content-Type:application/json",data:k}).success(function(b){a.loading=!1,g(b),a.close()}).error(function(b){a.loading=!1,c.error(b.message)}),a.shoppingItemList){var n="";for(d in a.shoppingItemList)n+=a.shoppingItemList[d].id+",";b({method:"PUT",url:"/rest/shoppingItem/wasBought/"+n,headers:"Content-Type:application/json"}).success(function(){}).error(function(a){c.error(a.message)})}}}}]),myApp.controller("CuShoppingItemCtrl",["$scope","$http","$flash","$modalInstance","shoppingItem","addItem","data",function(a,b,c,d,e,f,g){a.onlyForMe=!0,a.loading=!1,a.mySelf=g.mySelf,a.fields={description:{fieldTitle:"generic.description",validationRegex:"[a-zA-Z0-9-]{1,255}",validationMessage:["generic.validation.size","1","255"],focus:function(){return!0},disabled:function(){return a.loading}}},a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.initialize=function(){e&&(a.edit=!0,a.fields.description.field=angular.copy(e.description),a.onlyForMe=angular.copy(e.onlyForMe))},a.initialize(),a.save=function(){for(var d in a.fields){var g=a.fields[d];a.fields.hasOwnProperty(d)&&(g.firstAttempt=!1)}if(a.allFieldValid()){var h,i="POST",j="/rest/shoppingItem";e?(h=e,h.description=a.fields.description.field,h.onlyForMe=a.onlyForMe,i="PUT",j+="/"+e.id):h={description:a.fields.description.field,onlyForMe:a.onlyForMe},a.loading=!0,b({method:i,url:j,headers:"Content-Type:application/json",data:h}).success(function(b){a.loading=!1,f(b),a.close()}).error(function(b){a.loading=!1,c.error(b.message)})}}}]),myApp.controller("ChangeEmailModalCtrl",["$scope","$http","$flash","$modalInstance","roommate","setEmail",function(a,b,c,d,e,f){a.loading=!1,a.fields={oldPassword:{name:"password",fieldTitle:"generic.oldPassword",validationRegex:"^[a-zA-Z0-9-_%]{6,18}$",validationMessage:"generic.validation.password",fieldType:"password",focus:function(){return!0},disabled:function(){return a.loading}},newEmail:{fieldType:"email",name:"email",fieldTitle:"changeEmailModal.email",validationRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,validationMessage:"generic.validation.email",disabled:function(){return a.loading}}},a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.save=function(){for(var d in a.fields){var g=a.fields[d];a.fields.hasOwnProperty(d)&&(g.firstAttempt=!1)}if(a.allFieldValid()){var h={oldPassword:a.fields.oldPassword.field,newEmail:a.fields.newEmail.field};a.loading=!0,b({method:"PUT",url:"/rest/roommate/email/"+e.id,headers:"Content-Type:application/json",data:h}).success(function(b){a.loading=!1,a.close(),f(b.email)}).error(function(b){a.loading=!1,c.error(b.message)})}}}]),myApp.controller("ChangePasswordModalCtrl",["$scope","$http","$flash","$modalInstance","roommate",function(a,b,c,d,e){a.loading=!1,a.fields={oldPassword:{name:"password",fieldTitle:"generic.oldPassword",validationRegex:"^[a-zA-Z0-9-_%]{6,18}$",validationMessage:"generic.validation.password",fieldType:"password",focus:function(){return!0},disabled:function(){return a.loading}},newPassword:{fieldTitle:"changePasswordModal.newPassword",validationRegex:"^[a-zA-Z0-9-_%]{6,18}$",validationMessage:"generic.validation.password",fieldType:"password",disabled:function(){return a.loading}},repeatPassword:{fieldTitle:"generic.repeatPassword",fieldType:"password",validationMessage:"generic.validation.repeatPassword",validation:function(){return a.o.newPassword===a.o.repeatPassword},disabled:function(){return a.loading}}},a.close=function(){d.close()},a.allFieldValid=function(){for(var b in a.fields){var c=a.fields[b];if(a.fields.hasOwnProperty(b)&&(null==c.isValid||c.isValid===!1))return!1}return!0},a.save=function(){for(var d in a.fields){var f=a.fields[d];a.fields.hasOwnProperty(d)&&(f.firstAttempt=!1)}if(a.allFieldValid()){var g={oldPassword:a.fields.oldPassword.field,newPassword:a.fields.newPassword.field};a.loading=!0,b({method:"PUT",url:"/rest/roommate/password/"+e.id,headers:"Content-Type:application/json",data:g}).success(function(){a.loading=!1,a.close()}).error(function(b){a.loading=!1,c.error(b.message)})}}}]),myApp.controller("CalculatorModalCtrl",["$scope","$modalInstance","setResult",function(a,b,c){a.input="",a.memory="",a.acceptOperator=!1,a.close=function(){a.result();var d=parseFloat(a.memory);d&&c(d),b.close()},a.press=function(b){a.input+=b},a.clear=function(){a.input=""},a.clearAll=function(){a.input="",a.memory=""},a.clearLastOne=function(){a.input=a.input.slice(0,a.input.length-1)},a.operation=function(b){parseFloat(a.input)||!isNaN(a.memory)?(a.memory+=a.input+" ",a.memory+=b+" ",a.input=""):a.memory.length>0&&(a.memory=a.memory.slice(0,a.memory.length-2)+b+" ")},a.result=function(){a.memory+=a.input+" ",a.memory=math.eval(a.memory),a.input=""},document.onkeypress=function(b){b=b||window.event,49==b.keyCode?a.press(1):50==b.keyCode?a.press(2):51==b.keyCode?a.press(3):52==b.keyCode?a.press(4):53==b.keyCode?a.press(5):54==b.keyCode?a.press(6):55==b.keyCode?a.press(7):56==b.keyCode?a.press(8):57==b.keyCode?a.press(9):48==b.keyCode?a.press(0):46==b.keyCode||44==b.keyCode?a.press("."):43==b.keyCode?a.operation("+"):47==b.keyCode?a.operation("/"):48==b.keyCode?a.operation("-"):42==b.keyCode?a.operation("*"):63==b.keyCode||13==b.keyCode?a.result():127==b.keyCode&&a.clear(),a.$apply()}}]),myApp.directive("dirFieldDate",["directiveService","$filter","generateId",function(a,b,c){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/dirFieldDate/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return a.id=c.generate(),a.idHtag="#"+a.id},post:function(c){a.autoScopeImpl(c),c.result=null,c.$watch("result",function(){return c.resultFormated=b("date")(c.result,"yyyy-MM-dd")}),c.$watch("getInfo().field",function(){return null!=c.getInfo().field?c.result=new Date(Number(c.getInfo().field)):void 0}),c.$watch("result",function(){return c.getInfo().field=null!=c.result?c.result.getTime():null,c.isValid()}),c.isValid=function(){var a;return c.getInfo().disabled===!0||c.getInfo().hidden===!0?void(c.getInfo().isValid=!0):(a=!0,null==c.getInfo().field&&(a=!1),void(c.getInfo().isValid=a))},c.isValid(),c.logField=function(){return console.log(c.getInfo())},c.displayError=function(){return 0==c.getInfo().isValid&&c.getInfo().firstAttempt===!1?!0:!1}}}}}}]),myApp.directive("dirFieldText",["directiveService","$timeout","$modal",function(a,b,c){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/dirFieldText/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(b){return a.autoScopeImpl(b)},post:function(d){a.autoScopeImpl(d),void 0==d.getInfo().autoCompleteValue&&(d.getInfo().autoCompleteValue=[]),d.errorMessage="",d.isValidationDefined=null!=d.getInfo().validationRegex||null!=d.getInfo().validationFct,d.hideIsValidIcon=!!d.getInfo().hideIsValidIcon,d.fieldType=null!=d.getInfo().fieldType?d.getInfo().fieldType:"text",null==d.getInfo().field&&(d.getInfo().field=""),null==d.getInfo().isValid&&(d.getInfo().isValid=!d.isValidationDefined),d.isValidationDefined&&d.$watch("getInfo().field",function(a,b){return a!==b?d.isValid():void 0}),d.isValid=function(){var a;return d.getInfo().disabled===!0||d.getInfo().hidden===!0?void(d.getInfo().isValid=!0):(d.getInfo().field||(d.getInfo().field=""),a=!0,"string"!=typeof d.getInfo().field&&(d.getInfo().field+=""),null!=d.getInfo().validationRegex&&(a=null!=d.getInfo().field.match(d.getInfo().validationRegex)),null!=d.getInfo().validationFct&&(a=a&&d.getInfo().validationFct()),void(d.getInfo().isValid=a))},d.isValid(),d.logField=function(){return console.log(d.getInfo())},d.setErrorMessage=function(a){return d.errorMessage=a,null!=d.lastTimeOut&&b.cancel(d.lastTimeOut),d.lastTimeOut=b(function(){return d.errorMessage="",d.lastTimeOut=null},2e3)},d.displayError=function(){return 0==d.getInfo().isValid&&d.getInfo().firstAttempt===!1?!0:!1},d.openCalculator=function(){var a={setResult:function(){return function(a){d.getInfo().field=a}}};c.open({templateUrl:"/assets/javascripts/modal/Calculator/view.html",controller:"CalculatorModalCtrl",size:"sm",resolve:a})}}}}}}]),myApp.directive("numbersOnly",["$filter","translationService","$locale",function(a,b,c){return{restrict:"A",require:"ngModel",link:function(b,d,e,f){return b.$watch(e.numbersOnly,function(){var d,g,h,i,j,k,l;return"integer"!==e.numbersOnly&&"double"!==e.numbersOnly&&"percent"!==e.numbersOnly||(b.lastValidValue=0,"integer"===e.numbersOnly?(i=a("translateText")("ONLY_INTEGER"),k=0):(i=a("translateText")("ONLY_NUMBER"),k=2),b.$root.$on("$localeChangeSuccess",function(){var a;return null!=f.$modelValue&&(a=g(parseFloat(f.$modelValue)),null!=a)?(f.$setViewValue(a.toString()),f.$render()):void 0}),f.$parsers.unshift(function(a){var c,g,i;return""===a?null:(c=d(a),isNaN(c)?(h(),b.lastValidValue?(g=b.lastValidValue.toString(),i="percent"===e.numbersOnly?(100*b.lastValidValue).toString():b.lastValidValue.toString()):(g="",i=""),f.$setViewValue(i),f.$render()):("percent"===e.numbersOnly&&(c/=100),b.lastValidValue=c,g=c.toString()),""===g?null:g)}),f.$formatters.unshift(function(a){return b.displayValue(a)}),b.displayValue=function(a){var b;return b=parseFloat(a),"percent"===e.numbersOnly&&(b=100*b),g(b)},h=function(){return null!=b.setErrorMessage?b.setErrorMessage(i):void 0},g=function(a){var b,d;return null==a||isNaN(a)?"":(a=a.toFixed(k),b=c.NUMBER_FORMATS,d=a.toString().replace(new RegExp("\\.","g"),b.DECIMAL_SEP))},d=function(a){var b,d,e;return""===a?0/0:(d=c.NUMBER_FORMATS,b=d.DECIMAL_SEP,"."===b&&(b="\\."),e=a.replace(new RegExp(b,"g"),"."),j(e))},j=function(a){var b;return a.isNaN?0/0:(b=new RegExp("integer"===e.numbersOnly?"^(\\-|\\+)?([0-9]+|Infinity)?$":"^(\\-|\\+)?([0-9]+(\\.[0-9]*)?|Infinity)?$"),b.test(a)?Number(a):0/0)},null==f.$modelValue)?void 0:(b.lastValidValue=parseFloat(f.$modelValue),l=b.displayValue(b.lastValidValue),f.$setViewValue(l),f.$render())})}}}]),myApp.directive("dirUserIcon",["directiveService","$filter","generateId",function(a){return{restrict:"E",scope:a.autoScope({ngUser:"=",ngLittle:"="}),templateUrl:"/assets/javascripts/directive/dirUserIcon/template.html",replace:!0,transclude:!0,link:function(b){a.autoScopeImpl(b),b.getName=function(){return b.getUser().nameAbrv},b.getColor=function(){return b.getUser().iconColor}}}}]),myApp.directive("dirFocusMe",["$timeout","$parse",function(){return{restrict:"A",scope:{dirFocusMe:"="},link:function(a,b){a.$watch("dirFocusMe",function(){return a.dirFocusMe===!0?b[0].focus():void 0})}}}]),myApp.directive("dirEnter",function(){return function(a,b,c){return b.bind("keydown keypress",function(b){return 13===b.which?(a.$apply(function(){return a.$eval(c.dirEnter)}),b.preventDefault()):void 0})}}),myApp.service("$flash",["$filter",function(){Messenger.options={extraClasses:"messenger-fixed messenger-on-top messenger-on-center cr-messenger",theme:"block"},this.success=function(a){return Messenger().post({message:a,type:"success",showCloseButton:!0})},this.info=function(a){return Messenger().post({message:a,type:"info",showCloseButton:!0})},this.error=function(a){return Messenger().post({message:a,type:"error",showCloseButton:!0})},this.warning=function(a){return Messenger().post({message:a,type:"warning",showCloseButton:!0})}}]),myApp.service("directiveService",["$sce",function(a){this.autoScope=function(a){var b,c,d;c={};for(b in a)d=a[b],c[b]=d,"ng"===b.slice(0,2)&&"="===d&&(c[b[2].toLowerCase()+b.slice(3)]="@");return c},this.autoScopeImpl=function(b,c){var d,e,f;b.$$NAME=c;for(e in b)f=b[e],"ng"===e.slice(0,2)&&(d=function(a,b){return function(){var c;return c=0,c=void 0===a[b]||null===a[b]||""===a[b]?a[b[2].toLowerCase()+b.slice(3)]:a[b],a["decorate"+b.slice(2)]?a["decorate"+b.slice(2)](c):c}},b["get"+e.slice(2)]=d(b,e));return b.isTrue=function(a){return a===!0||"true"===a||"y"===a},b.isFalse=function(a){return a===!1||"false"===a||"n"===a},b.isNull=function(a){return null===a},b.html=function(b){return a.trustAsHtml(b)}}}]),myApp.service("generateId",["$rootScope",function(){this.generate=function(){var a,b,c;for(c="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;20>a;)c+=b.charAt(Math.floor(Math.random()*b.length)),a++;return c}}]),myApp.service("translationService",["$rootScope","$filter","$http","$locale",function(a,b){var c;c=this,c.elements=null,c.set=function(a){c.elements=a.translations},c.get=function(a){var b=c.elements[a];return b},c.translateExceptionsDTO=function(a){return null!=a.params&&Object.keys(a.params).length>0?b("translateTextWithVars")(a.messageToTranslate,a.params):null!=a.messageToTranslate?b("translate")(a.messageToTranslate):a.message}}]),myApp.filter("translateText",["$sce","translationService",function(a,b){return function(a,c){var d;if("object"==typeof a){d=b.get(a[0]);for(var e in a)0!=e&&(d=d.replace("{"+(parseFloat(e)-1)+"}",a[e]));return d}if(d=b.get(a),null!=c)if("array"==typeof c)for(var e in c)d=d.replace("{"+e+"}",c[e]);else d=d.replace("{0}",c);return d}}]);